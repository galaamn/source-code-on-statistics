---
title: "Олон хэмжээст өгөгдлийн статистик шинжилгээ хичээлийн бие даалтын үлгэрчилсэн жишээ"
subtitle: "Ургийн өсөлт дэх тамхидалтын нөлөө"
author: "Г.Махгал"
date: "2021 оны 4 сарын 26"
header-includes:
   - \usepackage[mongolian]{babel}
output:
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
    fig_caption: yes
    citation_package: biblatex
#    keep_tex: yes
bibliography: bibliography.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, fig.align='center', fig.height = 3, fig.env = "figure", fig.pos="!ht", fig.ext='pdf')
options(xtable.comment = FALSE)
```

\begin{abstract}
Үүгээр шинэ төрсөн хүүхдийн биеийн жин болон өндөр буюу ургийн өсөлтөд эцэг эхийнх нь тамхидалт нөлөөтэй эсэхийг шинжлэн тогтоосон судалгааны үр дүнг танилцуулна. Шинжилгээнд олон хэмжээст хэвийн тархалт сэдвээр үзсэн олон хувьсагчийн регрессийн шугаман загвар улмаар шатлах алгоритм бүхий кластерын шинжилгээ болон хи-квадрат шинжүүр зэрэг зүйлс ашиглана.
\end{abstract}

# Өгөгдөл

''Birthweight_reduced_kg_R.csv'' [@mash] файлд буй өгөгдлийг `X` гэсэн датафрейм хэлбэртэй объект байдлаар ачаалав. 
```{r load data,echo=TRUE,eval=TRUE}
X <- read.csv(file = "Birthweight_reduced_kg_R.csv")
```

`X` датафрейм `r nrow(X)` мөр болон `r colnames(X)` гэсэн `r ncol(X)` баганатай. Эдгээр багана буюу хувьсагчдын тайлбар болон хэмжээсийн төрөл зэрэг мэдээллийг хүснэгт \ref{table:metadata} дээр харуулав.

```{r some rows of data by xtable,results='asis'}
xtable::xtable(x = data.frame(
  "Хувьсагчийн нэр" = c("ID", "Length", "Birthweight", "Headcirc", "Gestation", "smoker", "mage", "mnocig", "mheight", "mppwt", "fage", "fedyrs", "fnocig", "fheight", "lowbwt", "mage35"),
  "Тайлбар" = c("ялгах дугаар", "хүүхдийн өндөр (см)", "хүүхдийн жин (кг)", "толгойн тойрог (см)", "тээсэн хугацаа (долоо хоног)", "эх нь тамхи татдаг бол 1 үгүй бол 0", "эхийн нас", "эхийн нь өдөрт татах тамхины тоо", "эхийн өндөр (см)", "эхийн жирэмслэлтээс өмнөх жин (кг)", "эцгийн нас", "эцгийн боловсролд зарцуулсан жил", "эцгийн нь өдөрт татах тамхины тоо", "эцгийн өндөр (см)", "дутуу жинтэй төрсөн бол 1 үгүй бол 0", "эх нь 35-аас дээш настай бол 1 үгүй бол 0"),
  "Хэмжээсийн төрөл" = c("дискрет", "тасралтгүй", "тасралтгүй", "тасралтгүй", "дискрет", "нэрлэсэн", "дискрет", "дискрет", "тасралтгүй", "тасралтгүй", "дискрет", "дискрет", "дискрет", "тасралтгүй", "нэрлэсэн", "нэрлэсэн"),
  check.names = FALSE
), caption = "Өгөгдөл дэх хувьсагчдын нэр, тайлбар болон хэмжээсийн төрөл", label = "table:metadata", display = rep("s", times = 4), digits = 0, booktabs = TRUE)
```

Өгөгдөлд чанарын гурван хувьсагч байгаа бөгөөд эдгээрээс зайшгүй шаардлагатай нэг хувьсагчийг фактор төрөлд дараах байдлаар хувиргав.
```{r,echo=TRUE}
X$smoker <- factor(x = X$smoker, levels = 1:0, labels = c("Yes", "No"), ordered = FALSE)
```

```{r some rows of data by kable}
#knitr::kable(head(X), caption = "\\label{table:some-rows-of-data}Өгөгдлийн эхний 6 мөр", row.names = TRUE, col.names = c(""), table.envir = "table", longtable = TRUE, booktabs = TRUE, position = "center")
```

# Шинжилгээний хэсэг

Эхлээд шинэ төрсөн хүүхдийн биеийн жин болон хэмжээг тамхидалттай шууд холбож үзье. Хүүхдийн биеийн жин болон хэмжээг `r names(X[2:5])` хувьсагчид илэрхийлэх тул эдгээр хувьсагчдыг ашиглана. Манай тохиолдолд хүүхдийн эх болон эцэг тамхи татдаг эсэхээс үүдсэн дөрвөн хувилбар байна.
```{r,echo=TRUE}
table(
  X$smoker,
  factor(x = X$fnocig > 0, levels = c("TRUE", "FALSE"), labels = c("Yes", "No"), ordered = FALSE)
) ->
  freq
print(freq)
```
Энэ нь ургийн өсөлтөд ямар нөлөө үзүүлдэг нь одоохондоо тодорхойгүй юм. Иймд кластерын тоо тодорхойгүй байх үед хийдэг шатлах алгоритм бүхий кластерын шинжилгээ [@makhgal2017, \S 5.2.1] хийнэ. Гэвч эх болон эцгийн тамхидалт хамааралгүй буюу тус тусдаа хүчин гэдэг нь батлагдахгүй байна. Үүнийг хи-квадрат шинжүүрийн [@jamyansharav2017 \S 13.1.3] тусламжтай тогтоосон.
```{r,echo=TRUE}
chisq.test(freq, simulate.p.value = TRUE)
```
```{r}
rm(freq)
```
Тодруулбал тамхи их татдаг ба бага эсвэл огт татдаггүй гэсэн хоёр бүлэгт эцэг эхчүүдийг хуваахад бүлгүүд хамааралгүй гэсэн тэг таамаглал үл няцаагдаж байна.

> Иймд эх болон эцгийн тамхидалттай холбогдуулан олон кластерт хуваах шаардлагагүй бололтой.

Түүнчлэн `r names(X[2:5])` хувьсагчдын утга агуулга үүнийгээ дагаад масштаб нь харилцан адилгүй байгаа тулд мастабын нөлөөг арилгахын тулд хувьсагчид дээр стандарт хувиргалт хийсний дараа зайн матриц олов.
```{r,echo=TRUE}
d <- dist(scale(X[2:5]))
```
Кластер хоорондын зайн хувьд ''single'', ''average'' зэрэг нь утга учиргүй кластер хуваалт гаргаж байсан тул ашиглаагүй. Харин ''complete'' болон ''Ward'' зай ашигласан үед бараг ижил кластер хуваалт гарсан. Иймд ''Ward'' зай ашиглана.
```{r,echo=TRUE}
cl <- hclust(d, method = "ward.D")
```
Шинжилгээгээр тод ялгарал бүхий кластерууд ажиглагдаж байгааг зураг \ref{figure:hclust-X} дээрх дендрограммаас харж болно.
```{r,echo=TRUE,fig.cap="\\label{figure:hclust-X}Шинэ төрсөн хүүхдийн биеийн хэмжээг хоёр кластерт хувааж ангилсан нь"}
plot(cl, labels = FALSE)
rect.hclust(cl, k = 2, border = "red")
```
Дендрограммыг ажиглавал кластерын тоог 2 эсвэл 3 хэмээн авч болохоор ажээ.

Шатлах алгоритм бүхий кластерын шинжилгээгээр тод ялгарал бүхий кластерууд гарсан ч эдгээр нь хүүхдийн эцэг эхийн тамхидалттай ямар ч холбоогүй байна. Тухайлбал кластерын тоо 2 байх тохиолдлыг авч үзье.
```{r,echo=TRUE}
groups <- cutree(cl, k = 2)
```
Энэ тохиолдолд тус хоёр кластер эхийн тамхи татах байдалтай хамааралтай болох нь батлагдахгүй байгааг дараах байдлаар тогтоож болно.
```{r,echo=TRUE}
chisq.test(table(groups, X$smoker), simulate.p.value = TRUE)
```
Хи-квадрат шинжүүрийн хувьд тэг таамаглал нь чанар хувьсагчид хамааралгүй гэсэн байдгийг сануулъя. Цаашилбал эх эцэг нь тамхи их татдаг эсэхтэй ч холбогдолгүй байгааг дараах үр дүнгээс харна уу.
```{r,echo=TRUE}
chisq.test(table(groups, X$fnocig > 25), simulate.p.value = TRUE)
```

> Иймд шинэ төрсөн хүүхдийн биеийн хэмжээ буюу ургийн өсөлтийг эцэг эхийн тамхидалтаар шууд тайлбарлах боломжгүй ажээ.

Хүүхдийн өндөр, жин зэрэгт эх, эцгийн өндөр, жин, нас зэрэг хүчин зүйлс нөлөөтэй байж болох тул эдгээрийн нөлөөг тэдгээр хувьсагчдаас зайлуулсаны дараа тамхидалтын нөлөөг сонирхож үзье. Үүний тулд дараах хоёр бүлэг хувьсагчдыг ялгаж авлаа.
```{r,echo=TRUE}
X2 <- X[2:5]
X1 <- X[c(7,9:11,14)]
```
Ийнхүү $$X_2=(\text{`r colnames(X2)`})$$ санамсаргүй вектороос $$X_1=(\text{`r colnames(X1)`})$$ санамсаргүй векторын нөлөөг зайлуулахаар
\begin{align*}
 X_2 & = E(X_2|X_1)+U \\
 & = \mu_2+\Sigma_{21}\Sigma_{11}^{-1}(X_1-\mu_1)+U \\
 & = \beta_0+BX_1+U
\end{align*}
олон хувьсагчтай регрессийн шугаман загвар ашиглана [@makhgal2017, \S 2.8.1]. Энд $B=\Sigma_{21}\Sigma_{11}^{-1}$, $\beta_0=\mu_2-B\mu_1$ хэмээн үзсэн билээ. Цаашилбал $\mu_1=E(X_1)$, $\mu_2=E(X_2)$ харин $\Sigma_{21}=\operatorname{cov}(X_2,X_1)$, $\Sigma_{11}=\operatorname{cov}(X_1)$ байна. $B$ матриц болон $\beta_0$ векторыг түүврээс
```{r,echo=TRUE}
B <- cov(X2,X1) %*% solve(cov(X1))
b0 <- colMeans(X2) - B %*% colMeans(X1)
```
байдлаар үнэлбэл дараах үр дүн гарна.
$$B = \left(
```{r,results='asis'}
print(xtable::xtable(B, align = NULL, digits = 2), floating = FALSE, tabular.environment="array", hline.after = NULL, include.rownames = FALSE, include.colnames = FALSE)
```
\right)$$
$$\beta_0 = \left(
```{r,results='asis'}
print(xtable::xtable(b0, align = NULL, digits = 2), floating = FALSE, tabular.environment="array", hline.after = NULL, include.rownames = FALSE, include.colnames = FALSE)
```
\right)$$
Улмаар $$U=X_2-(\beta_0+BX_1)$$ байдлаар $X_2$ дээрх $X_1$ санамсаргүй векторын нөлөөг зайлуулна. Үүний тулд дараах хэлбэртэй код бичиж ажиллуулна.
```{r,echo=TRUE}
U <- X2 - t(replicate(n = nrow(X2), expr = as.vector(b0)) + B %*% t(X1))
```
Ийнхүү $X_2$ буюу `r names(X2)` хувьсагчдаас $X_1$ буюу `r names(X1)` хувьсагчдын нөлөөг зайлуулсанаа $U$ буюу R програмын `U` объектод хадгаллаа. Мөн `U` нь датафрейм хэлбэртэй байна.

Ийнхүү тамхидалтын хажуугаар нөлөөлж буй хөндлөнгийн зарим хүчин зүйлсийн нөлөөг зайлуулсан тул өмнө хийсэн кластерын шинжилгээгээ ахин шинээр хийх боломжтой боллоо. Энэ тохиолдолд `U` датафреймд буй өгөгдөл дээр шинжилгээ хийх нь мэдээжийн хэрэг юм. Мөн энэ удаад ч ''Ward'' зай тохиромжтой байна.
```{r,echo=TRUE}
d <- dist(scale(U))
cl <- hclust(d, method = "ward.D")
```
Кластерын шинжилгээний үр дүнг зураг \ref{figure:hclust-U} дээрх дендрограммаас харна уу.
```{r,echo=TRUE,fig.cap="\\label{figure:hclust-U}Тамхидалтын хажуугаар нөлөөлөх хөндлөнгийн зарим хүчин зүйлсийн нөлөөг зайлуулсаны дараа шинэ төрсөн хүүхдийн биеийн хэмжээг хоёр кластерт хувааж ангилсан нь"}
plot(cl, labels = FALSE)
rect.hclust(cl, k = 2, border = "red")
```
Мөн энд олсон хоёр кластер эцэг эхийн тамхидалттай холбогдолтой болох нь хи-квадрат шинжүүрийн тусламжтай батлагдаж байна.
```{r,echo=TRUE}
groups <- cutree(cl, k = 2)
chisq.test(table(groups, X$fnocig > 25), simulate.p.value = TRUE)
```
Бид дээр хүүхдийн эцэг тамхи их татдаг эсэх нь эхийн тамхи их татдаг эсэхтэй холбоотойг тогтоосноо эргэн санана уу.

> Ийнхүү шинэ төрсөн хүүхдийн биеийн жин болон хэмжээнд эцэг эхийнх нь тамхидалт нөлөөтэй гэсэн үр дүнд хүрлээ.

Үүнийг бас эхийн тамхидалттай шууд холбосон байдлаар хийж гүйцэтгэх боломжтой. Нөхөр өдөрт 25-аас олон янжуур татдаг байх нь эхнэр 7 буюу үүнээс олон янжуур татахтай холбоо хамааралтай болохыг дараах байдлаар харж болно.
```{r,echo=TRUE}
chisq.test(table(X$fnocig > 25, X$mnocig >= 7), correct = FALSE, simulate.p.value = TRUE)
```
Харин хүүхдийн эх өдөрт 6-аас олон янжуур татдаг байх нь бидний олсон хоёр кластертай холбогдолтой байж болохоор байгааг хи-квадрат шинжүүрийн үр дүнгээс харж болно.
```{r,echo=TRUE}
chisq.test(table(groups, X$mnocig >= 7), correct = FALSE)
```
Түүнчлэн жирэмсэн эх тамхиа хаяж чадахгүй байлаа гэхэд тамхины хэрэглээгээ өдөрт 6 буюу үүнээс цөөн янжуур болтол бууруулах шаардлагатай гэсэн судалгааны дүгнэлт [@Kataoka2018] байгаа нь бидний гаргасан үр дүн үндэслэлтэй болохыг нотолсон явдал юм.

# Дүгнэлт

1. Шинэ төрсөн хүүхдийн биеийн жин болон өндөр буюу ургийн өсөлтөд эцэг эхийн тамхидалт нөлөөлж байна.
2. Тамхидалтын нөлөөг илрүүлэхийн тулд эцэг эхийн өндөр, биеийн жин зэрэг хүчин зүйлсийг тооцох шаардлагатай.
3. Жирэмсэн эх ургийн өсөлтдөө мэдэгдэхүйц дарамт учруулахгүй гэвэл тамхиа хаях буюу хэрэглээгээ өдөрт 6 янжуураас ихгүй болтол бууруулах хэрэгтэй.

# Ашигласан материал